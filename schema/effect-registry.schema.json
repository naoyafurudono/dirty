{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/naoyafurudono/dirty/schema/effect-registry.schema.json",
  "title": "Effect Registry",
  "description": "Schema for the Effect Registry - declaring function effects in the dirty analyzer",
  "type": "object",
  "required": ["version", "effects"],
  "properties": {
    "version": {
      "description": "Schema version for future compatibility",
      "type": "string",
      "enum": ["1.0"]
    },
    "effects": {
      "description": "Mapping of function names to their effect expressions",
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "pattern": "^\\{\\s*(\\s*[a-zA-Z_][a-zA-Z0-9_.-]*\\[[a-zA-Z_][a-zA-Z0-9_.-]*\\]\\s*(\\|\\s*[a-zA-Z_][a-zA-Z0-9_.-]*\\[[a-zA-Z_][a-zA-Z0-9_.-]*\\]\\s*)*)?\\s*\\}$",
        "examples": [
          "{ }",
          "{ select[users] }",
          "{ select[users] | insert[logs] }",
          "{ network[external-api] | io[file.system] }"
        ]
      },
      "examples": [{
        "GetUser": "{ select[users] }",
        "CreateUser": "{ insert[users] }",
        "ProcessPayment": "{ select[users] | update[balance] | insert[transactions] }"
      }]
    }
  },
  "additionalProperties": false,
  "examples": [{
    "version": "1.0",
    "effects": {
      "GetUser": "{ select[users] }",
      "CreateUser": "{ insert[users] }",
      "UpdateUserStatus": "{ update[users] | insert[audit_logs] }",
      "ValidateInput": "{ }",
      "ExternalAPICall": "{ network[external_api] | select[cache] | insert[logs] }"
    }
  }]
}
